(require 'evil)
(evil-mode 1)
(setcdr evil-insert-state-map nil) ;;insertモード中はevilはロック
(define-key evil-insert-state-map [escape] 'evil-normal-state);;ロック中でもescは有効
;C-qをescに
(defun evil-escape-or-quit (&optional prompt)
  (interactive)
  (cond
   ((or (evil-normal-state-p) (evil-insert-state-p) (evil-visual-state-p)
        (evil-replace-state-p) (evil-visual-state-p)) [escape])
   (t (kbd "C-g"))))
(define-key key-translation-map (kbd "C-q") #'evil-escape-or-quit)
(define-key evil-operator-state-map (kbd "C-q") #'evil-escape-or-quit)
(define-key evil-normal-state-map [escape] #'keyboard-quit)
;;以下、２つは不具合があるため、一番下に記述
(require 'mode-line-color)
(require 'evil-mode-line)
